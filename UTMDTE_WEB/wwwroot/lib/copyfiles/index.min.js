/**
 * Minified by jsDelivr using Terser v5.3.5.
 * Original file: /npm/copyfiles@2.4.1/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var path=require("path"),fs=require("fs"),glob=require("glob"),mkdirp=require("mkdirp"),untildify=require("untildify"),through=require("through2").obj,noms=require("noms").obj;function toStream(t){var e=t.length,o=0;return noms((function(r){o>=e&&this.push(null),this.push(t[o++]),r()}))}function depth(t){return path.normalize(t).split(path.sep).length-1}function dealWith(t,e){if(!e)return t;if(!0===e)return path.basename(t);if(depth(t)<e)throw new Error("cant go up that far");return path.join.apply(path,path.normalize(t).split(path.sep).slice(e))}var copyFile=_copyFile;function _copyFile(t,e,o,r){fs.createReadStream(t).pipe(fs.createWriteStream(e,{mode:o.mode})).once("error",r).once("finish",(function(){fs.chmod(e,o.mode,(function(t){r(t)}))}))}function makeDebug(t){return t.verbose?function(t){console.log(t)}:function(){}}function copyFiles(t,e,o){"function"==typeof e&&(o=e,e={up:0}),"object"!=typeof e&&e&&(e={up:e});var r=makeDebug(e),i=!1,n=e.up||0,u=e.soft;if("function"!=typeof o)throw new Error("callback is not optional");var p=t.slice(),a=p.pop(),f={};e.exclude&&(f.ignore=e.exclude),e.all&&(f.dot=!0),e.follow&&(f.follow=!0),a=a.startsWith("~")?untildify(a):a,toStream(p.map((function(t){return t.startsWith("~")?untildify(t):t}))).pipe(through((function(t,e,o){var i=this;glob(t,f,(function(t,e){if(t)return o(t);e.forEach((function(t){r("unglobed path: "+t),i.push(t)})),o()}))}))).on("error",o).pipe(through((function(t,e,o){fs.stat(t,(function(e,i){if(e)return o(e);var p=path.join(a,dealWith(t,n));function f(){mkdirp(path.dirname(p)).then((()=>{o(null,{pathName:t,pathStat:i})}),o)}return i.isDirectory()?(r("skipping, is directory: "+t),o()):i.isFile()?u?void fs.stat(p,(function(t){return t?"ENOENT"===t.code?f():o(t):o()})):f():o(new Error("how can it be neither file nor folder?"))}))}))).on("error",o).pipe(through((function(t,e,o){i||(i=!0);var u=t.pathName,p=t.pathStat,f=path.join(a,dealWith(u,n));r("copy from: "+u),r("copy to: "+f),copyFile(u,f,p,o)}))).on("error",o).on("finish",(function(){if(e.error&&!i)return o(new Error("nothing coppied"));o()}))}fs.copyFile&&(copyFile=function(t,e,o,r){fs.copyFile(t,e,r)}),module.exports=copyFiles;
//# sourceMappingURL=/sm/ada858260344f3b8628edea0d89035f33ca7e4c13ecca4310158aed505c28b40.map