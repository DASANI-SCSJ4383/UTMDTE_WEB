/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/eslint-plugin-unicorn@41.0.1/rules/prefer-top-level-await.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";const{findVariable:findVariable,getFunctionHeadLocation:getFunctionHeadLocation}=require("eslint-utils"),{matches:matches,memberExpressionSelector:memberExpressionSelector}=require("./selectors/index.js"),ERROR_PROMISE="promise",ERROR_IIFE="iife",ERROR_IDENTIFIER="identifier",SUGGESTION_ADD_AWAIT="add-await",messages={promise:"Prefer top-level await over using a promise chain.",iife:"Prefer top-level await over an async IIFE.",identifier:"Prefer top-level await over an async function `{{name}}` call.","add-await":"Insert `await`."},promiseMethods=["then","catch","finally"],topLevelCallExpression="CallExpression:not(:function *)",iife=[topLevelCallExpression,matches(['[callee.type="FunctionExpression"]','[callee.type="ArrowFunctionExpression"]']),"[callee.async!=false]","[callee.generator!=true]"].join(""),promise=[topLevelCallExpression,memberExpressionSelector({path:"callee",properties:promiseMethods,includeOptional:!0})].join(""),identifier=[topLevelCallExpression,'[callee.type="Identifier"]'].join(""),isPromiseMethodCalleeObject=e=>"MemberExpression"===e.parent.type&&e.parent.object===e&&!e.parent.computed&&"Identifier"===e.parent.property.type&&promiseMethods.includes(e.parent.property.name)&&"CallExpression"===e.parent.parent.type&&e.parent.parent.callee===e.parent,isAwaitArgument=e=>("ChainExpression"===e.parent.type&&(e=e.parent),"AwaitExpression"===e.parent.type&&e.parent.argument===e);function create(e){return{[promise](e){if(!isPromiseMethodCalleeObject(e)&&!isAwaitArgument(e))return{node:e.callee.property,messageId:"promise"}},[iife](t){if(!isPromiseMethodCalleeObject(t)&&!isAwaitArgument(t))return{node:t,loc:getFunctionHeadLocation(t.callee,e.getSourceCode()),messageId:"iife"}},[identifier](t){if(isPromiseMethodCalleeObject(t)||isAwaitArgument(t))return;const i=findVariable(e.getScope(),t.callee);if(!i||1!==i.defs.length)return;const[n]=i.defs,r="Variable"===n.type&&"const"===n.kind?n.node.init:n.node;return"ArrowFunctionExpression"!==r.type&&"FunctionExpression"!==r.type&&"FunctionDeclaration"!==r.type||r.generator||!r.async?void 0:{node:t,messageId:"identifier",data:{name:t.callee.name},suggest:[{messageId:"add-await",fix:e=>e.insertTextBefore(t,"await ")}]}}}}module.exports={create:create,meta:{type:"suggestion",docs:{description:"Prefer top-level await over top-level promises and async function calls."},hasSuggestions:!0,messages:messages}};
//# sourceMappingURL=/sm/c392f146bdbd9ea9f89183be4cd6c6eb44a51cf0759b1f32e822eab6d41046f8.map