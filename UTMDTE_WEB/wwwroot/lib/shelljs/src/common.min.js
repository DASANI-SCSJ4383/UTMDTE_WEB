/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/shelljs@0.8.5/src/common.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var os=require("os"),fs=require("fs"),glob=require("glob"),shell=require(".."),shellMethods=Object.create(shell);exports.extend=Object.assign;var isElectron=Boolean(process.versions.electron),DEFAULT_CONFIG={fatal:!1,globOptions:{},maxdepth:255,noglob:!1,silent:!1,verbose:!1,execPath:null,bufLength:65536},config={reset:function(){Object.assign(this,DEFAULT_CONFIG),isElectron||(this.execPath=process.execPath)},resetForTesting:function(){this.reset(),this.silent=!0}};config.reset(),exports.config=config;var state={error:null,errorCode:0,currentCmd:"shell.js"};function isObject(r){return"object"==typeof r&&null!==r}function log(){config.silent||console.error.apply(console,arguments)}function convertErrorOutput(r){if("string"!=typeof r)throw new TypeError("input must be a string");return r.replace(/\\/g,"/")}function error(r,e,t){if("string"!=typeof r)throw new Error("msg must be a string");var o={continue:!1,code:1,prefix:state.currentCmd+": ",silent:!1};"number"==typeof e&&isObject(t)?t.code=e:isObject(e)?t=e:"number"==typeof e?t={code:e}:"number"!=typeof e&&(t={}),t=Object.assign({},o,t),state.errorCode||(state.errorCode=t.code);var n=convertErrorOutput(t.prefix+r);if(state.error=state.error?state.error+"\n":"",state.error+=n,config.fatal)throw new Error(n);if(r.length>0&&!t.silent&&log(n),!t.continue)throw{msg:"earlyExit",retValue:new ShellString("",state.error,state.errorCode)}}function ShellString(r,e,t){var o;return r instanceof Array?((o=r).stdout=r.join("\n"),r.length>0&&(o.stdout+="\n")):(o=new String(r)).stdout=r,o.stderr=e,o.code=t,pipeMethods.forEach((function(r){o[r]=shellMethods[r].bind(o)})),o}function parseOptions(r,e,t){if("string"!=typeof r&&!isObject(r))throw new Error("options must be strings or key-value pairs");if(!isObject(e))throw new Error("parseOptions() internal error: map must be an object");if(t&&!isObject(t))throw new Error("parseOptions() internal error: errorOptions must be object");if("--"===r)return{};var o={};if(Object.keys(e).forEach((function(r){var t=e[r];"!"!==t[0]&&(o[t]=!1)})),""===r)return o;if("string"==typeof r){if("-"!==r[0])throw new Error("Options string must start with a '-'");r.slice(1).split("").forEach((function(r){if(r in e){var n=e[r];"!"===n[0]?o[n.slice(1)]=!1:o[n]=!0}else error("option not recognized: "+r,t||{})}))}else Object.keys(r).forEach((function(n){var s=n[1];if(s in e){var i=e[s];o[i]=r[n]}else error("option not recognized: "+s,t||{})}));return o}function expand(r){if(!Array.isArray(r))throw new TypeError("must be an array");var e=[];return r.forEach((function(r){if("string"!=typeof r)e.push(r);else{var t;try{t=(t=glob.sync(r,config.globOptions)).length>0?t:[r]}catch(e){t=[r]}e=e.concat(t)}})),e}exports.state=state,delete process.env.OLDPWD,exports.isObject=isObject,exports.log=log,exports.convertErrorOutput=convertErrorOutput,exports.error=error,exports.ShellString=ShellString,exports.parseOptions=parseOptions,exports.expand=expand;var buffer="function"==typeof Buffer.alloc?function(r){return Buffer.alloc(r||config.bufLength)}:function(r){return new Buffer(r||config.bufLength)};function unlinkSync(r){try{fs.unlinkSync(r)}catch(e){if("EPERM"!==e.code)throw e;fs.chmodSync(r,"0666"),fs.unlinkSync(r)}}function statFollowLinks(){return fs.statSync.apply(fs,arguments)}function statNoFollowLinks(){return fs.lstatSync.apply(fs,arguments)}function randomFileName(){return"shelljs_"+function r(e){if(1===e)return parseInt(16*Math.random(),10).toString(16);for(var t="",o=0;o<e;o++)t+=r(1);return t}(20)}function wrap(r,e,t){return t=t||{},function(){var o=null;state.currentCmd=r,state.error=null,state.errorCode=0;try{var n=[].slice.call(arguments,0);if(config.verbose&&console.error.apply(console,[r].concat(n)),state.pipedValue=this&&"string"==typeof this.stdout?this.stdout:"",!1===t.unix)o=e.apply(this,n);else{isObject(n[0])&&"Object"===n[0].constructor.name||(0===n.length||"string"!=typeof n[0]||n[0].length<=1||"-"!==n[0][0])&&n.unshift(""),n=(n=n.reduce((function(r,e){return Array.isArray(e)?r.concat(e):(r.push(e),r)}),[])).map((function(r){return isObject(r)&&"String"===r.constructor.name?r.toString():r}));var s=os.homedir();n=n.map((function(r){return"string"==typeof r&&"~/"===r.slice(0,2)||"~"===r?r.replace(/^~/,s):r})),config.noglob||!0!==t.allowGlobbing||(n=n.slice(0,t.globStart).concat(expand(n.slice(t.globStart))));try{isObject(t.cmdOptions)&&(n[0]=parseOptions(n[0],t.cmdOptions)),o=e.apply(this,n)}catch(r){if("earlyExit"!==r.msg)throw r;o=r.retValue}}}catch(r){if(!state.error)throw r.name="ShellJSInternalError",r;if(config.fatal)throw r}return t.wrapOutput&&("string"==typeof o||Array.isArray(o))&&(o=new ShellString(o,state.error,state.errorCode)),state.currentCmd="shell.js",o}}function _readFromPipe(){return state.pipedValue}exports.buffer=buffer,exports.unlinkSync=unlinkSync,exports.statFollowLinks=statFollowLinks,exports.statNoFollowLinks=statNoFollowLinks,exports.randomFileName=randomFileName,exports.wrap=wrap,exports.readFromPipe=_readFromPipe;var DEFAULT_WRAP_OPTIONS={allowGlobbing:!0,canReceivePipe:!1,cmdOptions:null,globStart:1,pipeOnly:!1,wrapOutput:!0,unix:!0},pipeMethods=[];function _register(r,e,t){if(t=t||{},Object.keys(t).forEach((function(r){if(!DEFAULT_WRAP_OPTIONS.hasOwnProperty(r))throw new Error("Unknown option '"+r+"'");if(typeof t[r]!=typeof DEFAULT_WRAP_OPTIONS[r])throw new TypeError("Unsupported type '"+typeof t[r]+"' for option '"+r+"'")})),t=Object.assign({},DEFAULT_WRAP_OPTIONS,t),shell.hasOwnProperty(r))throw new Error("Command `"+r+"` already exists");t.pipeOnly?(t.canReceivePipe=!0,shellMethods[r]=wrap(r,e,t)):shell[r]=wrap(r,e,t),t.canReceivePipe&&pipeMethods.push(r)}exports.register=_register;
//# sourceMappingURL=/sm/3852df5d5e7330218b114a31ac3ebb809cca95c2c09fac4a6dc9a7c9560fef1e.map