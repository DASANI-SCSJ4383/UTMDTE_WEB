/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/shelljs@0.8.5/src/cp.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var fs=require("fs"),path=require("path"),common=require("./common");function copyFileSync(o,n,e){fs.existsSync(o)||common.error("copyFileSync: no such file or directory: "+o);var c="win32"===process.platform;try{if(e.update&&common.statFollowLinks(o).mtime<fs.statSync(n).mtime)return}catch(o){}if(common.statNoFollowLinks(o).isSymbolicLink()&&!e.followsymlink){try{common.statNoFollowLinks(n),common.unlinkSync(n)}catch(o){}var r=fs.readlinkSync(o);fs.symlinkSync(r,n,c?"junction":null)}else{var i=common.buffer(),t=i.length,s=t,l=0,m=null,a=null;try{m=fs.openSync(o,"r")}catch(n){common.error("copyFileSync: could not read src file ("+o+")")}try{a=fs.openSync(n,"w")}catch(o){common.error("copyFileSync: could not write to dest file (code="+o.code+"):"+n)}for(;s===t;)s=fs.readSync(m,i,0,t,l),fs.writeSync(a,i,0,s),l+=s;fs.closeSync(m),fs.closeSync(a),fs.chmodSync(n,common.statFollowLinks(o).mode)}}function cpdirSyncRecursive(o,n,e,c){if(c||(c={}),!(e>=common.config.maxdepth)){e++;var r="win32"===process.platform;try{fs.mkdirSync(n)}catch(o){if("EEXIST"!==o.code)throw o}for(var i=fs.readdirSync(o),t=0;t<i.length;t++){var s,l=o+"/"+i[t],m=n+"/"+i[t],a=common.statNoFollowLinks(l);if(c.followsymlink&&cpcheckcycle(o,l))console.error("Cycle link found."),s=fs.readlinkSync(l),fs.symlinkSync(s,m,r?"junction":null);else if(a.isDirectory())cpdirSyncRecursive(l,m,e,c);else if(a.isSymbolicLink()&&!c.followsymlink){s=fs.readlinkSync(l);try{common.statNoFollowLinks(m),common.unlinkSync(m)}catch(o){}fs.symlinkSync(s,m,r?"junction":null)}else a.isSymbolicLink()&&c.followsymlink?(a=common.statFollowLinks(l)).isDirectory()?cpdirSyncRecursive(l,m,e,c):copyFileSync(l,m,c):fs.existsSync(m)&&c.no_force?common.log("skipping existing file: "+i[t]):copyFileSync(l,m,c)}var y=common.statFollowLinks(o);fs.chmodSync(n,y.mode)}}function checkRecentCreated(o,n){var e=o[n];return o.slice(0,n).some((function(o){return path.basename(o)===path.basename(e)}))}function cpcheckcycle(o,n){if(common.statNoFollowLinks(n).isSymbolicLink()&&common.statFollowLinks(n).isDirectory()){var e=fs.realpathSync(o),c=fs.realpathSync(n);if(new RegExp(c).test(e))return!0}return!1}function _cp(o,n,e){o.followsymlink&&(o.noFollowsymlink=!1),o.recursive||o.noFollowsymlink||(o.followsymlink=!0),arguments.length<3?common.error("missing <source> and/or <dest>"):(n=[].slice.call(arguments,1,arguments.length-1),e=arguments[arguments.length-1]);var c=fs.existsSync(e),r=c&&common.statFollowLinks(e);return c&&r.isDirectory()||!(n.length>1)||common.error("dest is not a directory (too many sources)"),c&&r.isFile()&&o.no_force?new common.ShellString("","",0):(n.forEach((function(c,i){if(!fs.existsSync(c))return""===c&&(c="''"),void common.error("no such file or directory: "+c,{continue:!0});var t=common.statFollowLinks(c);if(!o.noFollowsymlink&&t.isDirectory())if(o.recursive){var s=r&&r.isDirectory()?path.join(e,path.basename(c)):e;try{common.statFollowLinks(path.dirname(e)),cpdirSyncRecursive(c,s,0,{no_force:o.no_force,followsymlink:o.followsymlink})}catch(o){common.error("cannot create directory '"+e+"': No such file or directory")}}else common.error("omitting directory '"+c+"'",{continue:!0});else{var l=e;r&&r.isDirectory()&&(l=path.normalize(e+"/"+path.basename(c)));var m=fs.existsSync(l);if(m&&checkRecentCreated(n,i))return void(o.no_force||common.error("will not overwrite just-created '"+l+"' with '"+c+"'",{continue:!0}));if(m&&o.no_force)return;if(""===path.relative(c,l))return void common.error("'"+l+"' and '"+c+"' are the same file",{continue:!0});copyFileSync(c,l,o)}})),new common.ShellString("",common.state.error,common.state.errorCode))}common.register("cp",_cp,{cmdOptions:{f:"!no_force",n:"no_force",u:"update",R:"recursive",r:"recursive",L:"followsymlink",P:"noFollowsymlink"},wrapOutput:!1}),module.exports=_cp;
//# sourceMappingURL=/sm/f316e862bff4c7afb68e9cae79c9f84a0ef47bc8e84cb3d9c5b4e4740b37f87f.map