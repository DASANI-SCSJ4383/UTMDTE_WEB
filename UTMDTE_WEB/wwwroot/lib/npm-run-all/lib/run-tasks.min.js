/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/npm-run-all@4.1.5/lib/run-tasks.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";const MemoryStream=require("memorystream"),NpmRunAllError=require("./npm-run-all-error"),runTask=require("./run-task");function remove(e,r){const n=e.indexOf(r);-1!==n&&e.splice(n,1)}module.exports=function(e,r){return new Promise(((n,t)=>{if(0===e.length)return void n([]);const o=e.map((e=>({name:e,code:void 0}))),u=e.map(((e,r)=>({name:e,index:r}))),i=[];let l=null,a=!1;function c(){null==l?n(o):t(l)}function m(){if(!a)if(a=!0,0===i.length)c();else{for(const e of i)e.abort();Promise.all(i).then(c,t)}}function s(){if(a)return;if(0===u.length)return void(0===i.length&&c());const e=r.stdout,n=Object.assign({},r),t=new MemoryStream(null,{readable:!1});r.aggregateOutput&&(n.stdout=t);const f=u.shift(),d=runTask(f.name,n);i.push(d),d.then((n=>{remove(i,d),a||(r.aggregateOutput&&e.write(t.toString()),o[f.index].code=n.code,(!n.code||(l=new NpmRunAllError(n,o),r.continueOnError))&&(!r.race||n.code)?s():m())}),(e=>{if(remove(i,d),!r.continueOnError||r.race)return l=e,void m();s()}))}const f=r.maxParallel,d="number"==typeof f&&f>0?Math.min(e.length,f):e.length;for(let e=0;e<d;++e)s()}))};
//# sourceMappingURL=/sm/8a0e9825deda9ea0dbac1eb64bca6465240ce26bb6e02ff4902ff8f0978467ff.map