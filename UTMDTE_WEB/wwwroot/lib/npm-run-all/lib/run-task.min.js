/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/npm-run-all@4.1.5/lib/run-task.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";const path=require("path"),chalk=require("chalk"),parseArgs=require("shell-quote").parse,padEnd=require("string.prototype.padend"),createHeader=require("./create-header"),createPrefixTransform=require("./create-prefix-transform-stream"),spawn=require("./spawn"),colors=[chalk.cyan,chalk.green,chalk.magenta,chalk.yellow,chalk.red];let colorIndex=0;const taskNamesToColors=new Map;function selectColor(e){let r=taskNamesToColors.get(e);return r||(r=colors[colorIndex],colorIndex=(colorIndex+1)%colors.length,taskNamesToColors.set(e,r)),r}function wrapLabeling(e,r,t){if(null==r||!t.enabled)return r;const n=padEnd(e,t.width),a=(r.isTTY?selectColor(e):e=>e)(`[${n}] `),s=createPrefixTransform(a,t);return s.pipe(r),s}function detectStreamKind(e,r){return null==e?"ignore":e===r&&r.isTTY?e:"pipe"}function cleanTaskArg(e){return e.pattern||e.op||e}module.exports=function(e,r){let t=null;const n=new Promise(((n,a)=>{const s=r.stdin,o=wrapLabeling(e,r.stdout,r.labelState),p=wrapLabeling(e,r.stderr,r.labelState),l=detectStreamKind(s,process.stdin),i=detectStreamKind(o,process.stdout),c=detectStreamKind(p,process.stderr),d={stdio:[l,i,c]};r.printName&&null!=o&&o.write(createHeader(e,r.packageInfo,r.stdout.isTTY));const u=r.npmPath||process.env.npm_execpath,h="string"==typeof u&&/\.m?js/.test(path.extname(u)),m=h?process.execPath:u||"npm",f=path.basename(u||"npm").startsWith("yarn"),g=["run"];h&&g.unshift(u),f?-1!==r.prefixOptions.indexOf("--silent")&&g.push("--silent"):Array.prototype.push.apply(g,r.prefixOptions),Array.prototype.push.apply(g,parseArgs(e).map(cleanTaskArg)),t=spawn(m,g,d),"pipe"===l&&s.pipe(t.stdin),"pipe"===i&&t.stdout.pipe(o,{end:!1}),"pipe"===c&&t.stderr.pipe(p,{end:!1}),t.on("error",(e=>{t=null,a(e)})),t.on("close",(r=>{t=null,n({task:e,code:r})}))}));return n.abort=function(){null!=t&&(t.kill(),t=null)},n};
//# sourceMappingURL=/sm/1950e85edb0de8eb159adfa43cb97a454e0e2bc16fe66d611d0b82f2d8d727ce.map