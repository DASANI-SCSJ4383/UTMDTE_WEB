/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/browser-sync@2.27.9/dist/utils.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.devIp=exports.UAParser=exports.easyExtender=exports.serveStatic=exports.connect=exports.portscanner=exports.defaultCallback=exports.arrayify=exports.eachSeries=exports.verifyConfig=exports.getConfigErrors=exports.isMap=exports.isList=exports.willCauseReload=exports.xip=exports.fail=exports.opnWrapper=exports.openBrowser=exports.getUaString=exports.getPort=exports.getPorts=exports._makeUrl=exports.getUrls=exports.getUrl=exports.getUrlOptions=exports.getHostIp=void 0;const devIp=require("dev-ip");exports.devIp=devIp;const portScanner=require("portscanner"),path=require("path"),UAParser=require("ua-parser-js");exports.UAParser=UAParser;const Immutable=require("immutable"),immutable_1=require("immutable"),_=require("./lodash.custom"),parser=new UAParser;function getHostIp(e,r){if(e){var t=e.get("host");if(t&&"localhost"!==t)return t;if(!1===e.get("detect")||!r.length)return!1}return!!r.length&&r[0]}function getUrlOptions(e){const r=e.get("scheme"),t=e.get("port"),o={},s=e.get("listen");if(!1===e.get("online")||s){const n=s||"localhost";return o.local=getUrl(`${r}://${n}:${t}`,e),Immutable.fromJS(o)}const n=xip((0,exports.getHostIp)(e,devIp()),e);let i="localhost";return e.get("xip")&&(i="127.0.0.1"),i=xip(i,e),Immutable.fromJS(getUrls(n,i,r,e))}function getUrl(e,r){var t="/",o=r.get("startPath");return o&&("/"===o.charAt(0)&&(t=""),e=e+t+o),e}function getUrls(e,r,t,o){var s={local:getUrl(_makeUrl(t,r,o.get("port")),o)};return e!==r&&(s.external=getUrl(_makeUrl(t,e,o.get("port")),o)),s}function _makeUrl(e,r,t){return e+"://"+r+":"+t}function getPorts(e,r){var t,o=e.get("port"),s=e.get("ports"),n=e.get("listen","localhost");s&&(o=s.get("min"),t=s.get("max")||null),(0,exports.getPort)(n,o,t,r)}function getPort(e,r,t,o){portScanner.findAPortNotInUse(r,t,{host:e,timeout:1e3},o)}function getUaString(e){return parser.setUA(e).getBrowser()}function openBrowser(e,r,t){const o=r.get("open"),s=r.get("browser");_.isString(o)&&r.getIn(["urls",o])&&(e=r.getIn(["urls",o]));const n=exports.opnWrapper;o&&("default"!==s?(0,exports.isList)(s)?s.forEach((function(r){n(e,r,t)})):n(e,s,t):n(e,null,t))}function opnWrapper(e,r,t){var o=_.isString(r)?{app:r}:Immutable.Map.isMap(r)?r.toJS():{};require("opn")(e,o).catch((function(){t.events.emit("browser:error")}))}function fail(e,r,t){e&&(_.isFunction(t)&&(r.message?t(r):t(new Error(r))),process.exit(1))}function xip(e,r){var t=r.get("hostnameSuffix");return r.get("xip")?e+".xip.io":t?e+t:e}function willCauseReload(e,r){return e.some((function(e){return!_.includes(r,path.extname(e).replace(".",""))}))}function getConfigErrors(e){var r=require("./config").errors,t=[];return e.get("server")&&e.get("proxy")&&t.push(r["server+proxy"]),t}function verifyConfig(e,r){var t=getConfigErrors(e);return!t.length||(fail(!0,t.join("\n"),r),!1)}function eachSeries(e,r,t){t=t||function(){};var o=0,s=function(){r(e[o],(function(r){r?(t(r),t=function(){}):++o>=e.length?t():s()}))};s()}function arrayify(e){return immutable_1.List.isList(e)?e.toArray():[].concat(e).filter(Boolean)}function defaultCallback(e){e&&e.message&&console.error(e.message)}exports.getHostIp=getHostIp,exports.getUrlOptions=getUrlOptions,exports.getUrl=getUrl,exports.getUrls=getUrls,exports._makeUrl=_makeUrl,exports.getPorts=getPorts,exports.getPort=getPort,exports.getUaString=getUaString,exports.openBrowser=openBrowser,exports.opnWrapper=opnWrapper,exports.fail=fail,exports.xip=xip,exports.willCauseReload=willCauseReload,exports.isList=Immutable.List.isList,exports.isMap=Immutable.Map.isMap,exports.getConfigErrors=getConfigErrors,exports.verifyConfig=verifyConfig,exports.eachSeries=eachSeries,exports.arrayify=arrayify,exports.defaultCallback=defaultCallback,exports.portscanner=portScanner,exports.connect=require("connect"),exports.serveStatic=require("./server/serve-static-wrapper").default(),exports.easyExtender=require("easy-extender");
//# sourceMappingURL=/sm/7c43d21265da4fa53f186543b89a16e84e11af4bc7b4a58c1f9999828523cbeb.map