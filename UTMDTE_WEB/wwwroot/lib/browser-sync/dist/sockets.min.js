/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/browser-sync@2.27.9/dist/sockets.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.init=exports.plugin=void 0;const socket_io_1=require("socket.io"),utils=require("./server/utils");function plugin(e,t,o){return exports.init(e,t,o)}function init(e,t,o){var n=o.events,i=o.options.get("socket").toJS();"proxy"===o.options.get("mode")&&o.options.getIn(["proxy","ws"])&&((e=utils.getServer(null,o.options).server).listen(o.options.getIn(["socket","port"])),o.registerCleanupTask((function(){e.close()})));var s=i.socketIoOptions;s.path=i.path;const r=new socket_io_1.Server;return r.attach(e,Object.assign(Object.assign({},s),{pingTimeout:i.clients.heartbeatTimeout,cors:{credentials:!0,origin:(e,t)=>t(null,e)}})),r.of(i.namespace).on("connection",(e=>{!function(e){o.options.get("ghostMode")&&function(e){function o(t){e.on(t,(o=>{e.broadcast.emit(t,o)}))}t.forEach(o)}(e);e.emit("connection",o.options.toJS()),n.emit("client:connected",{ua:e.handshake.headers["user-agent"]})}(e)})),r.sockets=r.of(i.namespace),r}exports.plugin=plugin,exports.init=init;
//# sourceMappingURL=/sm/6e09592d24e8a0ea7f3317bb7952005cdb5ea89d675715499ac460c0ee3d2771.map