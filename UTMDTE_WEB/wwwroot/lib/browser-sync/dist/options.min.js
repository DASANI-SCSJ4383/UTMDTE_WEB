/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/browser-sync@2.27.9/dist/options.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setUiPort=exports.setMiddleware=exports.fixSnippetIncludePaths=exports.fixSnippetIgnorePaths=exports.fixRewriteRules=exports.liftExtensionsOptionFromCli=exports.setServerOpts=exports.setNamespace=exports.setStartPath=exports.setScheme=exports.setMode=exports.setOpen=exports.setProxyWs=void 0;const _=require("./lodash.custom"),Immutable=require("immutable"),defaultConfig=require("./default-config");function setProxyWs(e){return e.get("ws")&&"proxy"===e.get("mode")?[e.setIn(["proxy","ws"],!0),[]]:[e,[]]}function setOpen(e){return[e.update("open",(function(t){return("snippet"!==e.get("mode")||"ui"===t||"ui-external"===t)&&t})),[]]}function setMode(e){return[e.set("mode",e.get("server")?"server":e.get("proxy")?"proxy":"snippet"),[]]}function setScheme(e){var t="http";return e.getIn(["server","https"])&&(t="https"),e.get("https")&&(t="https"),e.getIn(["proxy","url","protocol"])&&"https:"===e.getIn(["proxy","url","protocol"])&&(t="https"),[e.set("scheme",t),[]]}function setStartPath(e){if(e.get("proxy")){var t=e.getIn(["proxy","url","path"]);if("/"!==t)return[e.set("startPath",t),[]]}return[e,[]]}function setNamespace(e){var t=e.getIn(["socket","namespace"]);return _.isFunction(t)?[e.setIn(["socket","namespace"],t(defaultConfig.socket.namespace)),[]]:[e,[]]}function setServerOpts(e){if(!e.get("server"))return[e,[]];var t=e.getIn(["server","index"])||"index.html",s=["server","serveStaticOptions"];return e.getIn(s)?e.hasIn(s.concat(["index"]))?[e,[]]:[e.setIn(s.concat(["index"]),t),[]]:[e.setIn(s,Immutable.Map({index:t})),[]]}function liftExtensionsOptionFromCli(e){return e.get("extensions")?[e.setIn(["server","serveStaticOptions"].concat(["extensions"]),e.get("extensions")),[]]:[e,[]]}function fixRewriteRules(e){return[e.update("rewriteRules",(function(e){return Immutable.List([]).concat(e).filter(Boolean)})),[]]}function fixSnippetIgnorePaths(e){var t=e.getIn(["snippetOptions","ignorePaths"]);return t?(_.isString(t)&&(t=[t]),t=t.map(ensureSlash),[e.setIn(["snippetOptions","blacklist"],Immutable.List(t)),[]]):[e,[]]}function fixSnippetIncludePaths(e){var t=e.getIn(["snippetOptions","whitelist"]);return t?(t=t.map(ensureSlash),[e.setIn(["snippetOptions","whitelist"],Immutable.List(t)),[]]):[e,[]]}function ensureSlash(e){return"/"!==e[0]?"/"+e:e}function setMiddleware(e){var t=getMiddlwares(e);return[e.set("middleware",t),[]]}function getMiddlwares(e){var t=e.get("middleware"),s=e.getIn(["server","middleware"]),r=e.getIn(["proxy","middleware"]),n=Immutable.List([]);return t?listMerge(n,t):s?listMerge(n,s):r?listMerge(n,r):n}function isList(e){return Immutable.List.isList(e)}function listMerge(e,t){return _.isFunction(t)&&(e=e.push(t)),isList(t)&&t.size&&(e=e.merge(t)),e}function setUiPort(e){return e.get("uiPort")?[e.setIn(["ui","port"],e.get("uiPort")),[]]:[e,[]]}exports.setProxyWs=setProxyWs,exports.setOpen=setOpen,exports.setMode=setMode,exports.setScheme=setScheme,exports.setStartPath=setStartPath,exports.setNamespace=setNamespace,exports.setServerOpts=setServerOpts,exports.liftExtensionsOptionFromCli=liftExtensionsOptionFromCli,exports.fixRewriteRules=fixRewriteRules,exports.fixSnippetIgnorePaths=fixSnippetIgnorePaths,exports.fixSnippetIncludePaths=fixSnippetIncludePaths,exports.setMiddleware=setMiddleware,exports.setUiPort=setUiPort;
//# sourceMappingURL=/sm/e8ea34464661a27dc31b045472abc3d2d5e7e5b7b7f4eabbf77f99fe93303eb9.map