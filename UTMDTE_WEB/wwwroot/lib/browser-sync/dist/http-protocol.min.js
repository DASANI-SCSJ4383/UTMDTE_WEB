/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/browser-sync@2.27.9/dist/http-protocol.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var queryString=require("qs"),proto=exports,instanceMethods=["exit","notify","pause","resume"],getBody=require("raw-body");const permittedSocketEvents=["file:reload","browser:reload","browser:notify","browser:location","options:set"];function methodRequiresInstance(e){return instanceMethods.indexOf(e)>-1}proto.getUrl=function(e,t){return[t,require("./config").httpProtocol.path,"?",queryString.stringify(e)].join("")},proto.middleware=function(e){return function(t,r){if("POST"===t.method)return getBody(t,(function(t,n){if(t){const e=["Error: could not parse JSON."];return r.writeHead(500,{"Content-Type":"text/plain"}),r.end(e.join("\n"))}try{const[t,o]=JSON.parse(n.toString());return e.io.sockets.emit(t,o),r.end(`Browsersync HTTP Protocol received: ${t} ${JSON.stringify(o)}`)}catch(e){const t=[`Error: ${e.message}`];return r.writeHead(500,{"Content-Type":"text/plain"}),r.end(t.join("\n"))}}));var n,o=queryString.parse(t.url.replace(/^.*\?/,""));if(!Object.keys(o).length)return n=["Error: No Parameters were provided.","Example: http://localhost:3000/__browser_sync__?method=reload&args=core.css"],r.writeHead(500,{"Content-Type":"text/plain"}),void r.end(n.join("\n"));try{var i=methodRequiresInstance(o.method)?e:e.events;require("./public/"+o.method)(i).apply(null,[o.args]),n=["Called public API method `.%s()`".replace("%s",o.method),"With args: "+JSON.stringify(o.args)],r.end(n.join("\n"))}catch(e){return r.writeHead(404,{"Content-Type":"text/plain"}),r.write("Public API method `"+o.method+"` not found."),void r.end()}}};
//# sourceMappingURL=/sm/9611851bd75280e48d3756c2b75900833dbcc50c89b204ceacd75992196b269d.map