/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/@coreui/vendors-injector@1.1.4/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
#!/usr/bin/env node
"use strict";const fs=require("fs-extra"),path=require("path"),{basename:basename}=path,{dirname:dirname}=path,{resolve:resolve}=path,extension=path.extname,jsdom=require("jsdom"),{JSDOM:JSDOM}=jsdom,beautify=require("js-beautify").html,jsbOptions={indent_size:2,indent_inner_html:!0,unformatted:[""],content_unformatted:["textarea"],extra_liners:[""]},selectors='[href^="node_modules"],[src^="node_modules"],[xlink:href^="node_modules"]',dist="dist",getVendorName=e=>Boolean(e.indexOf("@")>=0)?`${e.split("/")[1]}/${e.split("/")[2]}`:`${e.split("/")[1]}`,updateVendorUrl=e=>{let t;e.file?t=e.file:(e.src&&(t=e.src),e.href&&(t=e.href),e.getAttributeNS("http://www.w3.org/1999/xlink","href")&&(t=e.getAttributeNS("http://www.w3.org/1999/xlink","href")));const r=`vendors/${getVendorName(t)}/${extension(t.replace(".map","")).replace(".","").replace(/#.*/g,"")}/${basename(t)}`;return e.file||(e.src&&(e.src=r),e.href&&(e.href=r),e.getAttributeNS("http://www.w3.org/1999/xlink","href")&&e.setAttributeNS("http://www.w3.org/1999/xlink","href",r)),{oldUrl:t,newUrl:r}},getVendors=e=>{let t,r;const s=e.includes("<html")&&e.includes("</html>");s?(t=new jsdom.JSDOM(e),r=t.window.document.querySelectorAll(selectors)):(t=JSDOM.fragment(`<dom>${e}</dom>`),r=t.querySelectorAll(selectors));let o=[];Array.from(r).map((e=>{const t=updateVendorUrl(e);if(o.push(t),".css"===extension(t.oldUrl)||".js"===extension(t.oldUrl)){const e=`${t.oldUrl}.map`;if(fs.existsSync(e)){const t=updateVendorUrl({file:e});o.push(t)}}if(".css"===extension(t.oldUrl)){const e=fs.readFileSync(resolve(t.oldUrl),"ascii").toString().match(/(?:url)\((.*?)\)/gi);e&&e.forEach((e=>{if(e.includes("http://")||e.includes("https://"))return;const r=e.match(/(?:url)\((.*?)\)/)[1];if(void 0!==r){const e=r.replace(/\?.*|#.*/,"").replace(/\'|\"/,"");if(e.split("/").pop().indexOf(".")>-1){const r=resolve(dirname(t.oldUrl),e),s=resolve(dist,dirname(t.newUrl),e);o.push({oldUrl:r,newUrl:s})}}}))}}));const l=s?beautify(t.serialize(),jsbOptions):t.firstChild.innerHTML;return{files:o,html:l}},injectVendors=e=>(getVendors(e).files.forEach((e=>{try{fs.copySync(resolve(e.oldUrl.replace(/#.*/g,"")),resolve(dist,e.newUrl.replace(/#.*/g,"")),{overwrite:!1})}catch(e){console.error(e)}})),getVendors(e).html),toFile=e=>{fs.readFile(e,{encoding:"utf8"},((t,r)=>{if(t)throw t;const s=injectVendors(r);fs.writeFile(e,s,(e=>{if(e)throw e}))}))};module.exports=injectVendors,module.exports.toFile=toFile;
//# sourceMappingURL=/sm/9fae47bed7f43e0f37c164dbb1cf307e4f2ea398f6eeae7f6a973e35384d19d7.map