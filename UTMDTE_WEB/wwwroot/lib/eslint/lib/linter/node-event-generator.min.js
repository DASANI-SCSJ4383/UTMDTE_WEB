/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/eslint@8.11.0/lib/linter/node-event-generator.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";const esquery=require("esquery");function union(...e){return[...new Set(e.flat())]}function intersection(...e){if(0===e.length)return[];let t=[...new Set(e[0])];for(const s of e.slice(1))t=t.filter((e=>s.includes(e)));return t}function getPossibleTypes(e){switch(e.type){case"identifier":return[e.value];case"matches":{const t=e.selectors.map(getPossibleTypes);return t.every(Boolean)?union(...t):null}case"compound":{const t=e.selectors.map(getPossibleTypes).filter((e=>e));return t.length?intersection(...t):null}case"child":case"descendant":case"sibling":case"adjacent":return getPossibleTypes(e.right);case"class":return"function"===e.name?["FunctionDeclaration","FunctionExpression","ArrowFunctionExpression"]:null;default:return null}}function countClassAttributes(e){switch(e.type){case"child":case"descendant":case"sibling":case"adjacent":return countClassAttributes(e.left)+countClassAttributes(e.right);case"compound":case"not":case"matches":return e.selectors.reduce(((e,t)=>e+countClassAttributes(t)),0);case"attribute":case"field":case"nth-child":case"nth-last-child":return 1;default:return 0}}function countIdentifiers(e){switch(e.type){case"child":case"descendant":case"sibling":case"adjacent":return countIdentifiers(e.left)+countIdentifiers(e.right);case"compound":case"not":case"matches":return e.selectors.reduce(((e,t)=>e+countIdentifiers(t)),0);case"identifier":return 1;default:return 0}}function compareSpecificity(e,t){return e.attributeCount-t.attributeCount||e.identifierCount-t.identifierCount||(e.rawSelector<=t.rawSelector?-1:1)}function tryParseSelector(e){try{return esquery.parse(e.replace(/:exit$/u,""))}catch(t){if(t.location&&t.location.start&&"number"==typeof t.location.start.offset)throw new SyntaxError(`Syntax error in selector "${e}" at position ${t.location.start.offset}: ${t.message}`);throw t}}const selectorCache=new Map;function parseSelector(e){if(selectorCache.has(e))return selectorCache.get(e);const t=tryParseSelector(e),s={rawSelector:e,isExit:e.endsWith(":exit"),parsedSelector:t,listenerTypes:getPossibleTypes(t),attributeCount:countClassAttributes(t),identifierCount:countIdentifiers(t)};return selectorCache.set(e,s),s}class NodeEventGenerator{constructor(e,t){this.emitter=e,this.esqueryOptions=t,this.currentAncestry=[],this.enterSelectorsByNodeType=new Map,this.exitSelectorsByNodeType=new Map,this.anyTypeEnterSelectors=[],this.anyTypeExitSelectors=[],e.eventNames().forEach((e=>{const t=parseSelector(e);if(t.listenerTypes){const e=t.isExit?this.exitSelectorsByNodeType:this.enterSelectorsByNodeType;return void t.listenerTypes.forEach((s=>{e.has(s)||e.set(s,[]),e.get(s).push(t)}))}(t.isExit?this.anyTypeExitSelectors:this.anyTypeEnterSelectors).push(t)})),this.anyTypeEnterSelectors.sort(compareSpecificity),this.anyTypeExitSelectors.sort(compareSpecificity),this.enterSelectorsByNodeType.forEach((e=>e.sort(compareSpecificity))),this.exitSelectorsByNodeType.forEach((e=>e.sort(compareSpecificity)))}applySelector(e,t){esquery.matches(e,t.parsedSelector,this.currentAncestry,this.esqueryOptions)&&this.emitter.emit(t.rawSelector,e)}applySelectors(e,t){const s=(t?this.exitSelectorsByNodeType:this.enterSelectorsByNodeType).get(e.type)||[],r=t?this.anyTypeExitSelectors:this.anyTypeEnterSelectors;let n=0,c=0;for(;n<s.length||c<r.length;)n>=s.length||c<r.length&&compareSpecificity(r[c],s[n])<0?this.applySelector(e,r[c++]):this.applySelector(e,s[n++])}enterNode(e){e.parent&&this.currentAncestry.unshift(e.parent),this.applySelectors(e,!1)}leaveNode(e){this.applySelectors(e,!0),this.currentAncestry.shift()}}module.exports=NodeEventGenerator;
//# sourceMappingURL=/sm/0f717be30c977850f3e20ca29ba9bbebb465b633e04000fc5f2475ccbac8fcc0.map